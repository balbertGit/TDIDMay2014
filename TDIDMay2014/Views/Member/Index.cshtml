
@{
    ViewBag.Title = "Index";
}

<h2>Workflow</h2>
<div class="container">

    <div class="row">
        <div class="col-md-2">
            <label class="smallMarginTop" for="inputProgram">Start Program</label>
        </div>
        <div class="col-md-3">
            <input class="form-control col-sm-5" id="inputProgram" placeholder="Enter Program Name">
        </div>
        <div class="col-md-2">
            <input class="smallMarginTop" type="button" id="sendStartProgram" value="Start" />
        </div>
    </div>
    <br />

    <div class="row">
        <div class="col-md-2">
            <label class="smallMarginTop" for="inputActivity">Start Activity</label>
        </div>
        <div class="col-md-3">
            <input class="form-control col-sm-5" id="inputActivity" placeholder="Enter Activity Name">
        </div>
        <div class="col-md-2">
            <input class="smallMarginTop" type="button" id="sendStartActivity" value="Start" />
        </div>
    </div>
    <br />

    <div class="row">
        <div class="col-md-2">
            <label class="smallMarginTop" for="inputProject">Start Project</label>
        </div>
        <div class="col-md-3">
            <input class="form-control col-sm-5" id="inputProject" placeholder="Enter Project Name">
        </div>
        <div class="col-md-2">
            <input class="smallMarginTop" type="button" id="sendStartProject" value="Start" />
        </div>
    </div>
    <br />

    <div class="row">
        <div class="col-md-2">
            <label class="smallMarginTop" for="inputProgram">Start Task</label>
        </div>
        <div class="col-md-3">
            <input class="form-control col-sm-5" id="inputTask" placeholder="Enter Task Name">
        </div>
        <div class="col-md-2">
            <input class="smallMarginTop" type="button" id="sendStartTask" value="Start" />
        </div>
    </div>
    <br />

    <div class="row">
        <div class="col-md-2">
            <label class="smallMarginTop" for="inputCompleteTask">Complete Task</label>
        </div>
        <div class="col-md-3">
            <input class="form-control col-sm-5" id="inputCompleteTask" placeholder="Enter Task Name">
        </div>
        <div class="col-md-2">
            <input class="smallMarginTop" type="button" id="sendCompleteTask" value="Complete" />
        </div>
    </div>
    <br />

    <div class="row">
        <div class="col-md-2">
            <label class="smallMarginTop" for="inputCompleteProject">Complete Project</label>
        </div>
        <div class="col-md-3">
            <input class="form-control col-sm-5" id="inputCompleteProject" placeholder="Enter Project Name">
        </div>
        <div class="col-md-2">
            <input class="smallMarginTop" type="button" id="sendCompleteProject" value="Complete" />
        </div>
    </div>
    <br />

    <div class="row">
        <div class="col-md-2">
            <label class="smallMarginTop" for="inputCompleteActivity">Complete Activity</label>
        </div>
        <div class="col-md-3">
            <input class="form-control col-sm-5" id="inputCompleteActivity" placeholder="Enter Activity Name">
        </div>
        <div class="col-md-2">
            <input class="smallMarginTop" type="button" id="sendCompleteActivity" value="Complete" />
        </div>
    </div>
    <br />

    <div class="row">
        <div class="col-md-2">
            <label class="smallMarginTop" for="inputCompleteProgram">Complete Program</label>
        </div>
        <div class="col-md-3">
            <input class="form-control col-sm-5" id="inputCompleteProgram" placeholder="Enter Program Name">
        </div>
        <div class="col-md-2">
            <input class="smallMarginTop" type="button" id="sendCompleteProgram" value="Complete" />
        </div>
    </div>
</div>

    <p>
        <div class="container">
            <div id="userListDialog" title="Who's Online?">
                <ul id="userList"></ul>
            </div>
            <div id="statusFeedDialog" title="Status Feed">
                <ul id="discussion"></ul>
                <div class="ui-dialog-buttonpane ui-widget-content ui-helper-clearfix">
                    <input type="text" id="message" />
                    <input type="button" id="sendMessage" value="Comment" />
                    <input type="hidden" id="displayName" />
                </div>
            </div>
        </div>
    </p>

    @section scripts
{
        <!--Reference the autogenerated SignalR hub script. -->
        <script src="/signalr/hubs"></script>

        <script type="text/javascript">
            $(function () {
                // Declare a proxy to reference the hub.
                var statusFeed = $.connection.statusFeedHub;
                // Create a function that the hub can call to broadcast messages.
                statusFeed.client.broadcastMessage = function (name, message, emailCount) {
                    // Html encode display name and message.
                    var encodedName = $('<div />').text(name).html();
                    var encodedMsg = $('<div />').text(message).html();
                    // Add the message to the page.
                    $('#discussion').append('<li><strong>' + encodedName
                        + '</strong>:&nbsp;&nbsp;' + encodedMsg + '</li>');
                    $('#emailCount').text(' ' + emailCount);
                };

                // function used to display the list of online users
                statusFeed.client.updateOnlineUsersList = function (userList) {
                    $('#userList').empty();
                    for (index = 0; index < userList.length; index++) {
                        var user = userList[index];
                        $('#userList').append('<li><strong>' + user + '</strong></li>');
                    }
                };


                // Get the user name and store it to prepend to messages.
                //$('#displayName').val(prompt('Enter your name:', ''));
                // Set initial focus to message input box.
                $('#message').focus();
                // Start the connection.
                $.connection.hub.start().done(function () {
                    statusFeed.server.getUserList();
                    $('#sendMessage').click(function () {
                        // Call the Send method on the hub.
                        statusFeed.server.send($('#displayName').val(), $('#message').val());
                        // Clear text box and reset focus for next comment.
                        $('#message').val('').focus();
                    });
                    $('#sendStartProgram').click(function () {
                        // Call the Send method on the hub.
                        statusFeed.server.sendWorkflowItem('Started', 'program', $('#inputProgram').val());
                        // Clear text box and reset focus for next comment.
                        $('#inputProgram').val('').focus();
                    });
                    $('#sendStartActivity').click(function () {
                        // Call the Send method on the hub.
                        statusFeed.server.sendWorkflowItem('Started', 'activity', $('#inputActivity').val());
                        // Clear text box and reset focus for next comment.
                        $('#inputActivity').val('').focus();
                    });
                    $('#sendStartProject').click(function () {
                        // Call the Send method on the hub.
                        statusFeed.server.sendWorkflowItem('Started', 'project', $('#inputProject').val());
                        // Clear text box and reset focus for next comment.
                        $('#inputProject').val('').focus();
                    });
                    $('#sendStartTask').click(function () {
                        // Call the Send method on the hub.
                        statusFeed.server.sendWorkflowItem('Started', 'task', $('#inputTask').val());
                        // Clear text box and reset focus for next comment.
                        $('#inputTask').val('').focus();
                    });
                    $('#sendCompleteProgram').click(function () {
                        // Call the Send method on the hub.
                        statusFeed.server.sendWorkflowItem('Completed', 'program', $('#inputCompleteProgram').val());
                        // Clear text box and reset focus for next comment.
                        $('#inputCompleteProgram').val('').focus();
                    });
                    $('#sendCompleteActivity').click(function () {
                        // Call the Send method on the hub.
                        statusFeed.server.sendWorkflowItem('Completed', 'activity', $('#inputCompleteActivity').val());
                        // Clear text box and reset focus for next comment.
                        $('#inputCompleteActivity').val('').focus();
                    });
                    $('#sendCompleteProject').click(function () {
                        // Call the Send method on the hub.
                        statusFeed.server.sendWorkflowItem('Completed', 'project', $('#inputCompleteProject').val());
                        // Clear text box and reset focus for next comment.
                        $('#inputCompleteProject').val('').focus();
                    });
                    $('#sendCompleteTask').click(function () {
                        // Call the Send method on the hub.
                        statusFeed.server.sendWorkflowItem('Completed', 'task', $('#inputCompleteTask').val());
                        // Clear text box and reset focus for next comment.
                        $('#inputCompleteTask').val('').focus();
                    });
                });

                //// process the form
                //$('formStartProgram').submit(function (event) {

                //    // get the form data
                //    // there are many ways to get this data using jQuery (you can use the class or id also)
                //    var formData = {
                //        'name': $('input[name=inputProgram]').val(),
                //    };

                //    // process the form
                //    $.ajax({
                //        type: 'POST', // define the type of HTTP verb we want to use (POST for our form)
                //        url: '/Member/StartProgram', // the url where we want to POST
                //        data: formData, // our data object
                //        dataType: 'json', // what type of data do we expect back from the server
                //        encode: true
                //    })
                //        // using the done promise callback
                //        .done(function (data) {

                //            // log data to the console so we can see
                //            console.log(data);

                //            // here we will handle errors and validation messages
                //        });

                //    // stop the form from submitting the normal way and refreshing the page
                //    event.preventDefault();
                //});


            });


        </script>

        <script>
            $(function () {
                //$("#statusFeedDialog").dialog({ minHeight: 300, maxHeight: 500, buttons: [{ text: "Ok", click: function () { $(this).dialog("option", "hide", { effect: "explode", duration: 1000 }); } }], position: { at: "right bottom" } });
                $("#userListDialog").dialog({ minHeight: 300, maxHeight: 500, position: { at: "left bottom" } });
                $("#statusFeedDialog").dialog({ minHeight: 300, maxHeight: 500, width: 800, position: { at: "right bottom" } });
            });
        </script>
    }
